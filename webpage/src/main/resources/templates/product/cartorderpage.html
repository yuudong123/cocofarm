<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
  <head>
    <th:block th:replace="~{fragments/head :: headFragment}"></th:block>
    <link rel="stylesheet" href="/css/product/cart.css" />
  </head>
  <body>
    <th:block th:replace="~{fragments/header :: headerFragment}"></th:block>
    <main>
      <div class="container">
        <h3 class="order_payment"><span class="blind">주문/결제</span></h3>
        <section id="section1" class="z-depth-1">
          <form id="orderForm">
            <table id="cartListAll" class="highlight">
              <tbody>
                <tr
                  th:each="cart: ${list}"
                  th:id="'cartItem-' + ${cart.cart_id}"
                >
                  <input type="hidden" name="cart" th:value="${cart.cart_id}" />
                  <td>
                    <img
                      th:src="'/images/'+${cart.product_image}"
                      style="width: 150px"
                    />
                  </td>
                  <td th:text="${cart.product_name}"></td>
                  <td>상품금액</td>
                  <td th:text="${cart.product_price}" id="productPrice"></td>
                  <td>주문개수 :</td>
                  <td th:text="${cart.amount}" id="amount"></td>

                  <td>주문금액</td>
                  <td
                    th:with="totalPrice=${cart.amount*cart.product_price}"
                    class="onePayPrice"
                  >
                    <span th:text="${totalPrice}"></span>
                  </td>
                </tr>
              </tbody>
            </table>
            <!-- 배송정보 -->
            <div class="orderinfo">
              <!-- 줄효과 제거  -->
              <style>
                .orderinfo table tr {
                  border-bottom: none;
                }
              </style>
              <table>
                <thead>
                  <tr>
                    <th><h5>배송정보</h5></th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td>
                      이름
                      <br />
                      <span th:text="${member.nickname}"></span>
                    </td>
                  </tr>
                  <tr>
                    <td>
                      전화번호
                      <br />
                      <span th:text="${member.phonenumber}"></span>
                    </td>
                  </tr>
                  <tr>
                    <td>
                      주소
                      <br />
                      <span th:text="${member.address}"></span>
                    </td>
                  </tr>
                  <!-- 가능 하다면 배송메세지 기능 -->
                </tbody>
              </table>
            </div>

            <hr />
            <div>주문 내용을 확인하였으며, 정보 제공 등에 동의합니다.</div>

            <span></span>
          </form>
        </section>
        <section id="section2" class="z-depth-1">
          <table id="orderpalce" class="order">
            <td>총상품금액</td>
            <td id="allprice" th:text="${allTotalPrice}">0</td>
            <td><button id="btnAllPayment">결제하기</button></td>
          </table>
        </section>
      </div>
    </main>
    <th:block th:replace="~{fragments/footer :: footerFragment}"></th:block>
    <script src="/js/cocofarm.js"></script>
  </body>

  <script>
    const btnAllPayment = document.querySelector("#btnAllPayment");
    const orderForm = document.querySelector("#orderForm");
    btnAllPayment.addEventListener("click", () => {
      if (confirm("결제 하시겠습니까?")) {
        orderForm.action = "/order/payresult";
        orderForm.method = "POST";
        orderForm.submit();
      }
    });
  </script>
</html>
